<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>30.04.2023</title>
    <link rel="icon" type="image/x-icon" href="../eg_favicon.JPG">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@200;300;400;600&display=swap" rel="stylesheet"> 
    <style>
      body {
        font-family: 'Source Code Pro', monospace;
        font-size: 14px;
        color: #e2e3e7;
        background-color: #232529;
        /*
        e2e3e7
        c4c7cf
        868d9a
        696e79
        41454c
        35383f
        292c31
        232529

        31333a
        */
      }

      h1 {
        text-align: center;
      }

      h1 > a {
        color: rgb(139, 233, 253);
      }

      h1, h2, h3, h4, h5, h6 {
        color: rgb(139, 233, 253);
      }

      a{
        text-decoration: none;
      }

      a:hover {
        color: #e2e3e7;
      }

      .container {
        max-width: 800px;
        border: 1px solid rgb(139, 233, 253);
        border-radius: 10px;
      }

      .bg-script {
        color: rgb(139, 233, 253);
        background-color: #31333a;
        padding: 20px;
        border: 1px solid rgb(139, 233, 253);
        border-radius: 10px;
        text-align: start;
        font-size: 15px;
        line-height: normal;
      }

      .navigation > a:hover {
        color: #31333a;
        background-color: rgb(139, 233, 253);
      }

    </style>
  </head>
  <body>
    <div class="container p-4 mt-5 mb-5">
        <h1><a href="../index.html" class="display-4">30.04.2023</a></h1>
        
        <hr>

        <h5>Intrussion Prevention</h5>
        <p>
            Siber güvenlik açısından önemli bir konudur. <br>
            Attack Patterns sekmesi altına bize yapılan saldırıları yakalayıp tedbir almamızı sağlayan konumdur. <br>
            Önlem almamızı sağlar, sonuç olarak Firewall'umuz olması tek başına güvenliği sağlamaz. <br>
            Çünkü içerideki makineler normal Client vs ve insanlar devamlı kullanıyorlar, ayrıca internete çıkabilmeleri için de içeriden dışarıya çıkmaları da serbert. <br>
            Dışarıdan içeriye giriş olamasa da içeriden bir Web Sitesine gidildiğinde talep geri dönerken içeriye girebiliyor sonuç olarak. <br>
            Çünkü biz o siteye bağlandığımızda onu biz davet etmiş oluyoruz, o da açık olan Port'tan yani iletişim kurulan Port'tan içeriye giriyor. <br>
            Bu şekilde içeriye sızarak saldırı yapılabiliyor. <br>
            Bu tarz açıklardan faydalanan saldırı türlerini Firewall'un öğrenip, önlem alabilmesi için bu sekmedeki Apply'a basarız ve Firewall bir Update'e gider. <br>
            Update yapıldıktan sonra bu sekmede saldırı tiplerinin öğrenildiğini görürüz. <br>
            Tabiki öğrenmiş olması tek başına bizi koruyacağı anlamına gelmez. <br>
            Global sekmesine gidiyoruz ve uygulamayı açıyoruz. <br>
            Local Network'ümüzü yani Internal Network'ümüzü gösteriyoruz. <br>
            İçeriye doğru gelen saldırıları ancak bu şekilde engelleyebiliriz. 
        </p>

        <h6>Anti-DoS/Flood Protection</h6>
        <p>
            Aynı anda trafiği kitleyecek kadar çok fazla Ping alınan saldırı çeşididir. <br>
            Bu saldırı türünü engellemek için de ekstra bir sekme oluşturmuşlar. <br>
            []Use TCP SYN Flood Protection <br>
            []Use UDP Flood Protection <br>
            -> UDP taşıyıcısı paketleri taşıyıp geri bildirmezken, TCP taşıyıcısı taşıdığı paketleri teslim ettiğine dair geri dönüp bilgi verir. <br>
            İki farklı taşıyıcı için de D D O S(Siteye Upload ederken güvenlik kurallarını tetikleyebileceğinden bu şekilde yazdım) Protection aktif hale getirilebilir. <br>
            İşaretleyip Apply'a basarız. <br>
            Aynı şekilde ICMP paketleri için de bir koruma vardır. <br>
            Günümüzde önemli sayılmayacak kadar kaynak tüketirler, o sebeple açık tutulmalarında fayda vardır.
        </p>

        <h6>Anti-Portscan</h6>
        <p>
            Hizmeti açtığımızda aşırı fazla Port kullanan cihazları yakalar ve trafiğini droplar. <br>
            Normalde bir cihaz 1 ya da 2 tane Port kullanır. <br>
            Çok fazla Port kullanılması anormal ve şüpheli bir durumdur.
        </p>

        <h6>Exceptions</h6>
        <p>
            Yukarıdaki tüm hizmetlerin istisnalarını bu konumdan belirtebiliriz.
        </p>

        <h6>Advanced</h6>
        <p>
            Performance Tuning bölümünde örneğin HTTP Server'ın DNS Server'ın vs bildirilmesi durumunda, o makineleri koruma anlamında daha fazla kaynak tüketir, onlara daha fazla odaklanır.
        </p>
        <p>
            Yukarıdaki tüm hizmetleri aslında ISP'lerde veriyor yani bizim bunu Local'de yapmamız ekstra bir önlem oluyor.
        </p>

        <h5>Server Load Balancing</h5>
        <p>
            Örnek olarak Internal'da IIS'imiz var ve bu Server'ın bozulduğu varsayalım. <br>
            Bu tarz durumlara önlem olarak genelde aynı servisten bir tane daha kurulmuş olur. <br>
            Bu şekilde aynı hizmeti veren birbirinin yedeği olan Server'ları Load Balancing çalıştırabiliriz. <br>

        </p>
        <p class="bg-script">
            > Network Protection <br>
            > Server Load Balacing <br>
            > Add Load Balancing Rule <br>
            > Service: HTTP <br>
            > Virtual Server: Şuanda Firewall VS görevi görebilir yani herkes ona yönelecek.(Any)
            > Real Servers: IIS1, IIS2 <br>
            > [+]Automatic firewall rules <br>
            > Save
        </p>

        <h5>VoIP</h5>
        <p>
            Açılımı Voice Over IP'dir. <br>
            IP üzerinden ses transferi yapar. <br>
            SIP ya da H.323 protokollerinden birisi ile yapılabilir. <br>
            VoIP hizmeti aldıysak Firewall'a gelen ses paketlerini nereye yönlendireceğimizi bildiriyoruz.
        </p>
        
        <hr>

        <h4>Web Protection</h4>
        <p>
            Internal'dan nerelere çıkılabildiğinin kontrolünün yapılması şirketler için önemli olabilir. <br>
            Örneğin yasaklı Web Site'lerine çıkışın engellenmesi gerekiyor. <br>
            Yani açık olan protokollerle gidilebilecek olan yerleri kontrol edebiliyoruz. <br>
            HTTPs açık olmasına rağmen hangi Web Site'lara gidilemeyeceğini belirliyoruz.
        </p>

        <h5>Web Filtering</h5>
        <p>
            Default authentication: Browser -> Tarayıcı üzerinden User kimliğini girmelidir. <br>
            Internal'dan internete çıkmak isteyen herkese Authentication sorar. <br>
            Domain entegrasyonunu yaptıktan sonra bunu açtıktan sonra Domain User'lar kendi id password'larıyla geçebilirler. <br><br>
        </p>
        <p>
            Default authentication: Agent -> Daha önceden Client'e Authentication Agent kurduysak alt alanda onu kullanır. 
        </p>
        <p>
            Default authentication: Active Directory SSO -> AD ile entegrasyon olduğu için, Log-on olduğu Session üzerinden AD ile arasındaki Authentication otomatik olarak arkaplanda geçiyor.
        </p>
        <p>
            Yukarıda sadece User'ları onayladık. <br>
            Şuanda hala bir filtreleme yapmamış durumdayız.
        </p>

        <h6>Policies</h6>
        <p>
            Devrede olan bir Policy yazılmış olduğunu görürüz. <br>
            Buradaki Policy'nin içinde sitelerin Content'leri ile alakalı başlıklar bulunur ve bunların tamamına Allow verildiğini görürüz. <br>
            Özetle Drugs, Criminal Activities vs. gibi başlıkları görürüz. <br>
            Hepsini Block'larsak gitmeye çalışacağımız çoğu Website'a erişimimiz engellenir.
        </p>

        <h6>Website</h6>
        <p>
          Website sekmesine geçersek; Block'lamak istediğimiz Web Sitesini girebiliriz.             
        </p>

        <h6>Downloads</h6>
        <p>
            Downloads bölümünde uzantılara göre Download edilebilecek dosyaları da Block'layabilriz. <br>
            [+]Block downloads target then 100 mb -> Dosya uzantısı yasaklı olmasa bile belirttiğimiz boyutun üstündeyse indirme Block'lanır.
        </p>

        <h6>Edit Filter Action</h6>
        <p>
          Antivirus sekmesini çalıştırırsak, yapılan tüm Download'lardan önce virüs taraması yapar yani Firewall, Antivirüs gibi davranır. <br>
          İstenirse Content'te çalışmak isteyen bir JavaScript Script'i var ise bunu da engellemesi sağlanabilir.
        </p>

        <h6>Additional Options</h6>
        <p>
          Google, Bing gibi arama motorları için SafeSearch'ı zorunlu hale getirir.
        </p>

        <h5>Policy Helpdesk</h5>
        <p>
            Gitmek isteyeceğimiz sitenin hangi kategoride olduğunu test etmek için bu sekmede FQDN'ini, hangi IP'den gidildiğini ve hangi User'ın gittiğini girersek görebiliriz.
        </p>

        <h5>Filtering Options</h5>
        <h6>Categories</h6>
        <p>
          Bu konumda örnekğin Drugs'ın alt başlıklarda 3 tane farklı kategoriye sahip olduğunu görüyoruz. <br>
          Yani Builtin olarak Sophos'un kendi yaptığı tanımlamalar vardır.
        </p>
        <p>
          İstersek kendimiz de kapsamlı bir kategori oluşturabiliriz;
          Örnek olarak şirket politikası gereği belli kategorileri banlamamız gerekiyor. <br>
          Kategori listesinden gerekli olarak başlıkları seçerek bir paket oluşturabiliyoruz. <br>
          Bu paketi Web Filtering'in altındaki Policy'ler sekmeksinde oluşturduğumuz paketi seçip Block'layıp istediğimiz siteleri tek bir satırda Block'lamış oluruz. <br>
          Gelmezse Web Fiter Profile oluşturabilirsin.
        </p>

        <h5>Application Control</h5>
        <p>
          Network Visiblity'i açıyoruz. <br>
          Katergorilere göre internette mimlenmiş, girişin güvensiz Web Sitelerin listelendiğini görürüz. <br>
          Bu listedeki Web Siteleri işaretleyip, erişime kapatabiliriz. <br>
          Apply'a basarsak, bizi Application Control Rules sayfasına atar, biz de bu konumda tanımlanan sayfaların kuralını yazarız. <br>
          Örneğin isim veririz, önceliğini belirleriz, block action alırız ve for: any'yi seçeriz. <br>
          Bu şekilde bu sitelere bizim Network'ümüzden kimse erişemez.
        </p>

        <hr>

        <h4>Email Protection</h4>
        <h5>SMTP</h5>
        <p>
          Mail Server'lar arasındaki iletişim SMTP protokolü ile yapılır, yapılan bu trafiği Sophos üzerinden denetleyebiliriz. <br>
          Bu denetimi Exchange'te yapabilir. <br>
          Geriye kalan Servis'ler ücretli olabilir, kursta üzerinde durulmadı.
        </p>
        
        <h4>Wireless Protection</h4>
        <p>
          Bu kısım tüm Wireless cihazlar için değil de Sophos'un ürettiği Wireless cihazlarını koruma için kullanılır.
        </p>

        <h4>Remote Access</h4>
        <p>
          Diyelimki dışarıdan, Internal Network'ümüze VPN bağlantısı yapmak istiyoruz. <br>
          Firewall'umuz VPN Server görevi görebilir. <br>
          Ayrı şekilde Windows VPN kurmak zorunda kalmayız, Firewall üzerinden bu işi direkt halledebiliriz. 
        </p>

        <h5>PPTP</h5>
        <p>
          Enable yapıyoruz. <br>
          Authentication için iki farklı seçenek vardır. <br><br>

          Local: Bağlanan kişi id pw girdiği zaman Firewall kendi üzerindeki bilgiye göre bunu değerlendirir. <br>
          Eğer Active Directory'e entegre ise gider ona da sorar vs. <br>
          Yani bu işi Firewall'un kendisi yapar. <br><br>

          RADIUS: Gelen kişi x kişi mi, mesai saatinde mi geliyor, x protokolüyle mi geliyor şeklinde çok detaylı bir Authentication yapmak istiyorsak bu protokolü kullanmalıyız. <br>
          RADIUS bu bağlamda genel bir kavramdır.
        </p>
        <p class="bg-script">
          > Authentication via: Local <br>
          > Users and Groups: VPN Users,(Yeni bir grup oluşturup ekleyebiliriz) <br>
          > Assign IP address by: IP address pool -> Firewall kendi Pool'undan atar. <br>
          || DHCP Seçersek DHCP Server'a gidip oradan Pool alır. <br>
          -> VPN Server kendisine ve onu kullanacak olanlara bir IP atamalıdır. <br>
          > Pool network: VPN Pool(PPTP)
        </p>
        <p>
          Server olarak VPN şuanda hazır durumda. <br>
          Client'te VPN bağlantısını yapıyoruz;
        </p>
        <p class="bg-script">
          > Search: VPN Settings <br>
          > Add a VPN connection <br>
          > Connection name: Firewall VPN-PPTP(Kendimiz bir isim veriyoruz) <br>
          > Server name or address: 10.3.34.100(Firewall'un dış bacağının IP'sini gireriz, yani internete çıkan Public(Real) IP'yi girmemiz gerekir.) <br>
          > VPN type: PP2P <br>
          > User name(optional): administrator@sirket3.com <br>
          > Password: Password1
        </p>
        <p>
          Şuanda VPN'e bağlandık fakat bağlı olmamız içeriye girebileceğimiz anlamına gelmiyor. <br>
          Sebep şu; VPN ile bağlanmak bir aşamadır, Firewall'dan o talepleri geçirmek başka bir aşamadır. <br>
          Bu sebeple Firewall kuralı yazmamız gerekiyor. <br>
          VPN Pool'undan IP verdiğimiz makineler PPTP ile geliyorsa içeri girebilsin şeklinde özellikle trafiğe izin veriliyor olması gerekiyor.
        </p>
        <p class="bg-script">
          > Network Protection <br>
          > Firewall <br>
          > Rules <br>
          > New Rules <br>
          > Sources: VPN Pool(PPTP) <br>
          > Services: CIFS -> Örneğin File Server'a erişilmek isteniyorsa bu protokol kullanılmalıdır. <br>
          -> Eğer istiyorsak RDP yapmasını da sağlamak için Microsoft Remote Desktop Protokolünü de buradan eklemeliyiz. <br>
          -> İhtiyaca göre Protokoller bu şekilde eklenir, Any girersek fiziksele direkt erişiyormuş gibi çalışır. <br>
          > Destinations: Erişilmek istenen makine ya da Network eklenebilir fakat ideali örneğin bir File Server'a erişilmesi gerekiyorsa sadece onu eklemektir.
        </p>

        <h5>L2TP over IPsex</h5>
        <p>
          Varsayalında kapalıdır önce hizmeti açıyoruz. <br>
          PPTP kıyasla biraz daha güvenli bir protokoldür. <br>
          Karar vermemiz gereken şey hangi Interface'ten gelen talepleri kabul edeceğidir. <br>
          Örneğin;
        </p>
        <p class="bg-script">
          > Interface: External(WAN) <br>
          > Authentication mode: Preshared key <br>
          > Preshared key: 123(Örneğin) <br>
          > Repaet: 123 <br>
          > Assign IP addressses by: IP address pool <br>
          > Pool network: VPN Pool(L2TP) <br>
          > Authentication via: Local <br>
          > User and Groups <br>
          -> VPN Users
        </p>
        <p>
          Şuandan itibaren L2TP VPN Connection'ları da kabul etmeye başlar. <br>
          Bağlantıyı yapacağımız ortamda;
        </p>
        <p class="bg-script">
          > Search: VPN Settings <br>
          > Add a VPN connection <br>
          > Connection name: Firewall VPN-L2TP(Kendimiz bir isim veriyoruz) <br>
          > Server name or address: 10.3.34.100(Firewall'un dış bacağının IP'sini gireriz, yani internete çıkan Public(Real) IP'yi girmemiz gerekir.) <br>
          > VPN type: L2TP <br>
          > Pre-shared key: 123
        </p>
        <p>
          Oluşturduğumuz sanal Ethernet'in Property'lerinden Securty Tab'ına geçiyoruz. <br>
          Allow these protocols'ü işaretleyip Microsoft CHAP'i Enable ediyoruz.
        </p>
        <p>
          Bu farklı bir protokol olduğu için PP2P için olduğu gibi bunun için de yeni bir Firewall kuralı yazmalıyız. <br>
          Ya da PP2P ile yazdığımız kuralı Edit'leyip L2TP'yi de ekleriz.
        </p>

        <h5>HTML5 VPN Portal</h5>
        <p>
          Bu hizmette varsayılanda kapalıdır, Enable ederiz. <br>
          Bu da bir VPN bağlantı yöntemidir. <br>
          Yine Connection type görüyoruz, VPN yapanların hangi yöntemle bağlanmalarını yani ne için bağlanacaklarını belirtiyoruz;
        </p>
        <p class="bg-script">
          > Remote Access <br>
          > HTML5 VPN Portal <br>
          > Name: RDP+HTML5 <br>
          > Connection type: Remote Desktop(Bu protokol genelde bunun için kullanılır) <br>
          > Destination: DC01(Örneğin) <br>
          > Allowed users(Userportal) <br>
          -> Admin, Administrator(Bu kişiler DC01'e Userportal üzerinden RDP yapabilecekler)
        </p>
        <p>
          Dışarıdan bir Network'ten Userportal'a Log-on olduğumuzda; <br>
          HTML5 VPN Portal sekmesinin geldiğini görüyoruz. <br>
          Bu şekilde bu konumdan çok hızlı bir şekilde RDP yapabiliriz.
        </p>

        <hr>

        <h4>Site-to-Site VPN</h4>
        <p>
          İki tane devasa Network olduğunu düşünelim, örneğin iki farklı Domain olsun. <br>
          Bunların içindeki bir çok makinenin her biri diğer Network'teki bir makineye bağlanmak ihtiyacı olsun. <br>
          Bu durumda her bir makine için tek tek VPN kurmak ve bağlantısını o şekilde sağlamak, uzun ve professiyonel olmayan bir yöntemdir. <br>
          Bunun yerine her iki Network'te bulunan Firewall'ları birbirlerine VPN ile eriştirmek daha kestirme ve professiyonel bir çözümdür. <br>
          Yani iki Firewall'un birbirine bağlanması aslında iki Router'ın arkadalarındaki Network'lerini birbirine eriştirmesi demektir. <br>
          Burada köprü görevi alacak olan hizmet Site-to-Site VPN'dir. <br>
          Site-to-Site VPN'i yapmadan önce iki tarafında Firewall'ların RDP vs trafiklerinin de geçebilmesi için önce L2TP protokolünün kurulmuş olması gerekiyor. <br>
          Çünkü Firewall'lar önce birbirinin sunduğu VPN Server'larına VPN ile bağlanmak zorundalar. <br>
          Bunun gerçekleştirilebilmesi için de iki Firewall'da da VPN'in kurulmuş olması gerekir, yani Remote Access'te L2TP ayarı yapılmış olmalıdır. <br>
          Daha sonra aşağıdaki örnekte olduğu gibi Site-to-Site VPN'i uygulayabiliriz;
        </p>
        <p class="bg-script">
          > Site-to-Site VPN <br>
          > IPsec <br>
          > Remote Gateway <br>
          -> Bize göre karşı Site'ı tarif etmemiz gerekiyor. <br>
          -> Karşı tarafta aynı şekilde bizi tarif edecek. <br>
          > New Remote Gateway <br>
          > Name: Sirket0-9 <br>
          > Gateway type: Respond only || Initiate connection <br>
          -> Initiate connection: Kalıcı bir Site-to-Site bağlantısı yapar, bir kez ve kopmaz. <br>
          -> Respond only: Normalde hat kapalıdır, iki taraftan herhangi biri diğerine erişmek istediğinde o anda hat açılır. <br>
          -> Biz initiate seçebiliriz. <br>
          > Gateway: -> Karşı taraftaki Firewall'un erişilebilecek bacağıdır. <br>
          -> Bizde tanımlı olmadığı için tanımlarız; <br>
          -> > Name: Sirket9 FW(Örneğin) <br>
          -> > Type: Host <br>
          -> > IPv4 address: 10.3.34.109(Örneğin)
          -> > Save <br>
          > Authentication type: Preshared key <br>
          > Key: 123 <br>
          > Repeat: 123 <br>
          > VPN ID type: IP address <br>
          > Remote networks: -> Site-to-Site bağlantı yapmak istediğimiz Firewall'un iç Network'lerini gireriz. <br>
          > + -> Name: Sirket9 Internal(Örneğin) <br> 
          -> > IPv4 address: 192.168.9.0 <br>
          > Apply
        </p>
        <p>
          Karşı tarafta birebir aynılarını yaptıktan sonra artık bağlantı kurulmaya hazırdır. <br>
          Bağlantıyı yapmak için Connections sekmesine gideriz;
        </p>
        <p class="bg-script">
          > New IPsec Connection <br>
          > Name: sirket0-9(Örneğin) <br>
          > Remote Gateway: Sirket0-9 <br>
          -> Daha önceden tanımladığımız Remote Gateway'i burada ilişkilendiriyoruz. <br>
          > Local interface: External(WAN) <br>
          -> Bizim Firewall'umuzun dış bacağıdır. <br>
          > Policy: AES-128(Örneğin) -> Bağlantıda kullanılanacak olan Encryption, karşı tarafta aynısını seçmiş olmalıdır. <br>
          > Local Networks: Internal(Network) <br>
          -> Kendi Internal Network'lerimizi sorar. <br>
          > [+]Automatic firewall rules <br>
          -> Bu bağlantı kurulduktan sonra paketlerin geçmesi için gerekli olan Firewall kurallarını otomatik olarak yazmasını sağlar.
        </p>
        <p>
          Karşı taraftada aynı kuralın yazılmış olması gerekiyor. <br>
          Direkt Site-to-site VPN menüden sekmesine tıklarsak kurduğumuz Tunnel'in Established olduğunu görüntüleriz.
        </p>

        <hr>
        
        <div class="text-center container p-3 bg-script">
          <div class="d-flex justify-content-evenly navigation">
            <a href="29-04-2023.html" class="bg-script">29.04.2023</a>
            <a href="" class="bg-script">xxx</a>
          </div>
        </div>
        

    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>