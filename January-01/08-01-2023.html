<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>08.01.2023</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:wght@200;300;400;600&display=swap" rel="stylesheet"> 

    <style>
      body {
        font-family: 'Source Code Pro', monospace;
        font-size: 14px;
        color: #e2e3e7;
        background-color: #232529;
        /*
        e2e3e7
        c4c7cf
        868d9a
        696e79
        41454c
        35383f
        292c31
        232529

        31333a
        */
      }

      h1, h2, h3, h4, h5, h6 {
        color: rgb(139, 233, 253);
      }

      a{
        text-decoration: none;
      }

      a:hover {
        color: #e2e3e7;
      }

      .container {
        max-width: 800px;
      }

      .bg-script {
        color: rgb(139, 233, 253);
        background-color: #31333a;
        padding: 20px;
        border-radius: 10px;
        text-align: center;
        font-size: 16px;
        line-height: normal;
      }

    </style>
  </head>
  <body class="container">
    <div class="container mt-5">
        <h1 class="display-4">08.01.2023</h1>
        <h4>DNS Server(DNS Servisi)</h4>
        <p>
            DNS'in işi Host Name'lerledir. Host Name'leri ve ona karşılık gelen IP'leri otomatik olarak öğrenebilen ve kaydedebilen, bu kayıtlarda bir değişiklik olursa otomatik olarak değiştirebilen ve Host Name sorgularına yanıt verebilen servistir. <br>
            Eğer bir Domain ortamı var ise en az 1 adet DNS Server olmak zorundadır.
            Work Group'ta olması gerekmez.
        </p>
        
        <h4>DNS Suffix</h4>
        <p>
            .com, .org vs nereden çıktı? <br>
            Ortak özelliklerine göre internet Network'ünde karmaşıklığı önlemek için kategorize ederler. Aynı zamanda bir güvenlik duvarıdırlar.<br>
            Domain'ler hiyerarşik olarak Level'lara ayrılmıştır. <br>
            En üst Level'da "Root Level Domain" yer alır. First Level Domain'ler, Root Level Domain'lere bağlılardır. <br>
            .edu - education <br>
            .com - commertial <br>
            .gov - goverment <br>
            .org - organization <br>
            Bunlar Top Level Domain'lerdir.(.tr, .en vs de dahildir) <br>
            Örneğin; ornek.com -> Second Level Domain'dir. <br>
            Örneğin; istanbul.ornek.com -> Sub Domain'dir. Second Level'dan sonra kaç nokta gelirse artık Sub Domain olarak adlandırılır. <br>
        </p>
        <p>
            Örnek olarak (www.ist.ornek.com)'i inceleyelim; <br>
            www.ist.ornek.com = FQDN(Full Qualified Domain Name) <br>
            www = Host Name <br>
            .ist = Sub Level Domain <br>
            .ornek.com = Second Level Domain, aynı zamanda DNS Suffix<br>
            ist.ornek.com = DNS Suffix <br>
            .com = Top Level Domain <br>
            www.ist.ornek.com. = (.), Root Domin'in ismidir. <br>
            Aslında her zaman .com'dan sonra da bir nokta daha vardır. Fakat bunu yazmak bir adres verirken adresin dünyada olduğunu söylemek gibi bir şeydir. Doğal olarak yazılmasına gerek yoktur.
        </p>
        <p>
            Root > .com, .gov ... > ornek, google > ist.ornek ... <br>
            Yukarıdakilerin her biri aslında bir Domain'dir. <br>
            Her birini ayrı ayrı yönetecek en az bir DNS Server gereklidir.
        </p>
        <p>
            DNS > DC > Forward Lookup Zones > Properties > Root Hints -> Hangi DNS'lerin olduğunu görürüz. <br>
            Dünyaya yayılmış olan 13 tane Root Domain ve bunları yöneten DNS Server'lar vardır. <br>
            C > Windows > System32 > DNS > Cache <br>
            Yukarıdaki konumda 13 tane Root Domain'in DNS Server bilgileri yer alır. <br>
            Dünyada bu Root Domain'lerin çok sayıda kopyası bulur, ağırlıklı olarak Avrupadadır. Root'lara bir ekleme vs. olduğunda orjinal Root kopyalarına bu değişikliklerin kopyalarını gönderir.
        </p>

        <h4>IANA(Internet Assigned Numbers Authority)</h4>
        <p>
            İnternettiki tüm kuralları koyan organizasyondur. <br>
            Bir şirket internette yer almak isterse bu organizasyondan Domian'i satın almak durumundadır. IANA aracı şirketlere bu Domain'leri satma yetkisi vermiştir. Domain satın almak isteyen şirketler, aracı şirketlerden bu Domain'leri satın alırlar. Daha doğrusu "Register" ederler. IANA, örneğin .com'a Register yapma yani kayıt girme veya yaptığı kaydı değiştirme, silme vs. gibi yetkiler vermiştir.
        </p>
        <p>
          Client'lerin DNS ayarlarına gidip belli bir DNS girersek eğer, tüm isim çözümlemelerini o DNS üzerinden yapar. Daha doğru isim çözümlemek için önce girilen DNS'i dener. Eğer çözümleme yapılamazsa süreç sıfırdan başlar. <br>
          Örneğin x şirketindeki bilgisayarların tümüne y DNS Server'ını ayarlarsak x bilgisayarları her sorgu yaptığında önce kendi üzerindeki Host Name Domain Cache'ine bakar karşılığını burada bulamazsa, y DNS Server'ının Cache'ine bakarak çözümlemeyi buradan yapar. DNS Server'ın Cache'inde de karşılığını bulamazsa eğer bu durumda DNS Server'ın kayıtları kontrol edilir. Bu süreçler daha detaylı olarak anlatılacak.
        </p>
        <p>
          Peki bu şekilde sipesifik olarak bir DNS Server belirlendiğinde, farklı bir DNS Server'da bulunan bir DNS Suffix'e erişmek istediğimizde neler olur? <br>
          Bu soru şu anlamda sorulmuştur; Örneğin bilgeadam.com Domain'ininde yer alan bir şiket bilgisayarından migros.com aratıldığı zaman bilgeadam.com'un DNS Server'ından isim çözümlemesi yapılmaya çalışılır. Fakat bu o DNS Server'da doğal olarak olmayan bir bilgi. Yani migros.com'un IP karşılığı bu DNS Server'da yok. Bu durumda neler olacak?
        </p>
        <p>
          Farklı bir Domain'e gidilmek isteniyorsa bilgeadam'ın dışında bir sorgu olduğu için "bilmiyorum" Respond'unu vermez. Çünkü bu sorgulanan Domain'de yetkili(Authorite) değildir. Bu tarz farklı bir Domain sorgulandığında Router'a gidilir. Sorgu yaptığımız makinenin bağlı olduğu Router; Root Hints'teki Root DNS Server'larına gidilip sorulur. <br>
          Bulunduğumuz DNS Server'a en yakın Root DNS Server'a yönlendirilir. -> Yönlendirmek demek aslında yeni bu sorgunun tekrardan bir üstten bir alta doğru yapılması anlamına gelir. <br>
          Root, uzantısı ".com" olduğu için "com" Domain'in DNS Server'ına bizi gönderir. <br>
          "com" DNS Server'ından tekrar sorgulandığında migros.com'un IP'si öğrenilir. Bu durum HTTP paketi ile makinemiz migros'un DNS Server'ına gidip işlemini yapabilir.
        </p>
        <p>
          DNS Server'larının(DNS Servisinin) da kendi Cache'i vardır. <br>
          Bir DNS Server kendisine DNS Client olabilir. <br>
          Yani kendisinden hizmet alabilir. <br>
          Bu Cache'i silmek için DC > Right Click > Clear Cache ya da komut ile > DC > CMD > dnscmd /clearcache
        </p>

        <h4>DNS Server kurmak</h4>
        <p>
          DNS Server kurabilmek için Server OS olmalı. <br>
          Makinenin Static IP'si olmalı. <br>
          Minimum Local Admin yetkisinde olunmalı <br>
          Server Manager > Manage > Add Role > Next > Next > DNS Server |+| > Next
        </p>
        <p>
          DNS Manager > Forward Lookup Zones -> İsme karşılık IP, <br>
          Rever Lookup Zones -> IP'ye karşılık isim. <br>
          DNS kurulduktan sonra, DNS'in hizmet verebilmesi için de yukarıdaki iki Folder'da olmalıdır. <br>
          Bir Forward Lookup Zone nasıl açılır ? <br>
          DNS Manager > Forward > New Zone > Primary Zone, Secondary Zone, Stub Zone -> 3 farklı Zone tipi vardır. <br>
          1) Primary; içine kayıt girebiliriz, varolan kaydı silebilir ya da değiştirebiliriz. İçine Update edilebilen kayıtlar alır yani Writable tiptedir. <br>
          2) Secondary; Ancak bir Primary(varolan)'nin, Secondary'si yapılabilir. Hata töleransı için Read-only şekilde Primary'inin bir kopyasıdır. İkisinin arasında organik bir ilişki vardır, Primary'deki güncellemeler Secondary'de replikalanır. <br>
          3) Stub Zone; -> Daha sonra açıklanacak.
        </p>
        <p>
          Next > Next > Zone Name > bilgeadam.com > Allow only -> Dynamic Update -> Default'takini seç. > Next <br>
          Zone açarak; Bu Domain'de Authorize olduğumuzu iddia ederiz. <br>
          Tüm Domain'lerin iletişimini sağlamak için internet servis sağlayıcıları aracı olurlar. Örneğin Tük Telekom üzerinden de DNS Server hizmeti yapılabilir. Türk Telekom'un DNS'i aracı olarak Root, .com gibi Domain'lere gitmeye gerek kalmadan isim çözümleme yapabilirler. <br>
          Sonuç olarak birden fazla PC farklı Domain'lerden farklı Domain'lere sürekli trafik yapıyolar. <br>
          Bir DNS Server'ı başka bir DNS Server'a Forward edebiliriz. Örneğin bilgeadam, migros ve vakko aynı internet sağlayıcısını kullanıyor olsunlar. Bu ISP'nin DNS Server'ında aralarındaki trafik Cache'e kayıtlı olduğu için(Sürekli trafik olduğunu var sayalım), bizim DNS Server'ımız bu ISP'nin DNS Server'ına Forward edilirse direkt onun Cache'inden isim çözümleme yapılır.(Root'a vs. uğramadan)
        </p>
        <p>
          Nasıl yapılır ? <br>
          DNS > DC > Properties > Forwarders > Use root hints of no forwarders are avaible -> Default'ta Root'a yönlendirir. > Edit Forwards -> 8.8.8.8 -> Rever -> Root'a sorar ve dns.google'dan getirir. <br>
          Rooting'lere gitmeden önce araya bir işlem sokarak girekt yukarıda verdiğimiz DNS Server'a gider. <br>
          Olumsuz yanıt alsa bile Root'a gitmez. <br>
          Root'a gidebilmesi için menudeki ilgili bölüm Chech edilmiş olmalı ve yukarıdaki DNS Server'a ulaşılamıyor olması gerekir. 
        </p>

        <h4>Conditional Forwarders(Koşullu Yönlendirme)</h4>
        <p>
          "x" Domain'ine gelen sorgular için o Domain'i bilen "y" DNS Server'ına git demektir. <br>
          DNS > DC > Conditional Forwarders > New > NetBIOS Name'i ve IP gireriz. <br>
          "y" DNS Server'ını bulur listeye getirir. <br>
          Confitional, Genel Forward, Root -> 3 şekilde Forward yapılır.
        </p>

        <h4>Secondary Zone yapmak</h4>
        <p>
          Primary'nin Read-only kopyasını almak. <br>
          DNS > DC > New Zone > Secondary > Kopyasını almak istediğimiz Zone yazılır. > Hedefin IP'si girilir. <br>
          Bu noktada eklenir fakat izin olmadığı için kayıtlara erişemeyiz. Bunun için Primary'nin Secondary Zone Transfer'ine izin vermiş olması gerekir. <br>
          DNS > DC > Zone > Right Click > Properties > Zone Transfers > Allow[+] > To any Servers[+] -> Herkese(internetteki) izin verir. > Server Listed[+]  -> Name Servers listesindeki herkese verir. <br>
          Sadece bu ekranda eklediğimiz Server'a izin verir. -> Only to the following servers[+] <br>
          Secondary Zone > Properties > Change > Primary Zone -> Sonradan değiştirebiliriz. <br>
          Replikasyon özelliği ortadan kalkar. -> Writable hale gelir.
        </p>

        <h4>SOA Kaydı(Start of Authority)</h4>
        <p>
          Primary'den Secondary'e Zone kuralı transferleridir. <br>
          Zone > Properties > SOA -> Burada değişiklik yapılabilmesi için Primary Zone olması gerekir. <br>
          Zone > Properties > SOA -> Serial Number; Zone'un içinde yapılan bir değişiklikte bu sayı artar. Sayaçtır. <br>
          Primary Server; Primary olan(replikasyonun yapıldığı) Server. <br>
          Refresh Internal; Primary, Secondary'e 15'da Refresh yapmasını söyler.(Primary'deki değişiklikleri alma periyodu) <br>
          Retry Interval -> Secondary, Primary'e erişemiyorsa yukarıdaki periyodu 10 dakikaya düşür. <br>
          Expires After -> Bu 1 gün boyunca dene(10 dk) eğer hala ulaşamıyorsak denemekten bu süre dolunca vazgeç. Zone hizmeti durdurulur. çünkü bilgiler artık güncel olmayabilir. <br>
          Genelde hergün IP'ler değişir yada değişme ihtimali çok yüksektir. Bu yüzden süre 1 gündür. <br>
          Minimum(default) TTL -> Ne kadar süre boyunca Cache'te tutulacak.(Bu Zone'dan öğrenilen bilginin Client2in Host Name Cache'inde kalma süresi) <br>
          TTL for this record -> SOA kaydının yaşama süresi. <br>
          SOA kaydının DNS Server'inin Cache'inde kalma süresidir. <br>
          Bu kaydı bir daha ne zaman okuyacağını belirler.
        </p>
        

        
        <div class="m-5 text-center">
          <a href="../December-12/31-12-2022.html" class="bg-script m-5">31.12.2022</a>
          <a href="08-01-2023.html" class="bg-script m-5">08.01.2023</a>
        </div>
        <div class="mt-4"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4" crossorigin="anonymous"></script>
  </body>
</html>